package com.br.alura.forum.infra.security; import com.br.alura.forum.model.Usuario; import org.springframework.security.authentication.UsernamePasswordAuthenticationToken; import org.springframework.security.core.Authentication; import org.springframework.security.core.context.SecurityContextHolder; import org.springframework.stereotype.Service; @Service public class TokenService { public void autenticarUsuario(Usuario usuario) { Authentication authentication = new UsernamePasswordAuthenticationToken( usuario, null, usuario.getAuthorities() ); SecurityContextHolder.getContext().setAuthentication(authentication); } public Usuario getUsuarioLogado() { Authentication authentication = SecurityContextHolder.getContext().getAuthentication(); if (authentication != null && authentication.getPrincipal() instanceof Usuario) { return (Usuario) authentication.getPrincipal(); } return null; } }